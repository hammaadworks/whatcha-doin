<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.4</storyId>
    <title>Refactor and Integrate HabitCreator into The Pile</title>
    <status>drafted</status>
    <generatedAt>2025-11-15</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/1-4-refactor-and-integrate-habitcreator-into-the-pile.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>a user</asA>
    <iWant>to be able to see and interact with the habit creation input field within "The Pile" column</iWant>
    <soThat>I can understand how to add new habits to my list.</soThat>
    <tasks>
      <task id="1">Refactor `HabitCreator.tsx` for integration</task>
      <task id="2">Integrate `HabitCreator` into `app/(main)/dashboard/page.tsx`</task>
      <task id="3">Verify basic interaction</task>
      <task id="4">Ensure responsiveness and accessibility</task>
    </tasks>
  </story>

  <acceptanceCriteria>
      <criterion id="1">**Given** the dashboard layout is present (Story 1.2) and a sample `HabitCard` is integrated (Story 1.3),</criterion>
      <criterion id="2">**When** I view "The Pile" column,</criterion>
      <criterion id="3">**Then** I see the `HabitCreator` component (input field and "+ Add Goal" button) integrated at the top or bottom of "The Pile" column.</criterion>
      <criterion id="4">**And** the `HabitCreator` is styled correctly and appears integrated into the layout.</criterion>
      <criterion id="5">**And** `npm run dev` shows this integrated component.</criterion>
      <criterion id="6">**And** basic interaction (typing in the input field) does not cause errors.</criterion>
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/PRD.md</path>
        <title>Product Requirements Document</title>
        <section>FR-2.1: Habit Management (Recurring Habits)</section>
        <snippet>Users must be able to create a new "habit" with a name via an inline input field within "The Pile" column. As the user types, a "+ Add Goal" button will appear...</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-1.md</path>
        <title>Epic Technical Specification: Core Application Foundation & Habit Integration</title>
        <section>Detailed Design</section>
        <snippet>HabitCreator (React Component): Provides an input for creating new habits. (To be integrated).</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 1.4: Refactor and Integrate HabitCreator into "The Pile"</section>
        <snippet>As a user, I want to be able to see and interact with the habit creation input field within "The Pile" column, so that I can understand how to add new habits to my list.</snippet>
      </doc>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>User Journey Flows - Habit Management</section>
        <snippet>Habit Creation Flow: To create a new habit, the user clicks an "add new" area in "The Pile", which reveals an inline input field for the habit's name.</snippet>
      </doc>
    </docs>
<code>
      <artifact>
        <path>components/habits/HabitCreator.tsx</path>
        <kind>React Component</kind>
        <symbol>HabitCreator</symbol>
        <reason>The primary component to be integrated. It may require refactoring to fit into the dashboard layout and to handle state changes initiated by the dashboard.</reason>
      </artifact>
      <artifact>
        <path>app/dashboard/page.tsx</path>
        <kind>Next.js Page</kind>
        <symbol>Dashboard</symbol>
        <reason>The page where the `HabitCreator` component will be rendered within "The Pile" section.</reason>
      </artifact>
    </code>
    <dependencies>
      <dependency ecosystem="npm">
        <group>Framework</group>
        <package>next</package>
        <package>react</package>
        <package>react-dom</package>
      </dependency>
      <dependency ecosystem="npm">
        <group>UI &amp; Styling</group>
        <package>tailwindcss</package>
        <package>@radix-ui/react-slot</package>
        <package>class-variance-authority</package>
        <package>clsx</package>
        <package>lucide-react</package>
        <package>tailwind-merge</package>
      </dependency>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>This story focuses on UI integration. The `HabitCreator` should be rendered within the dashboard layout. The existing logic within `HabitCreator` for creating a habit can be mocked or disabled for this story.</constraint>
    <constraint>Any refactoring of `HabitCreator.tsx` should be done to make it more reusable and to decouple it from any page-specific logic.</constraint>
  </constraints>
  <interfaces />
  <tests>
    <standards>The project follows a "Lean MVP" testing strategy using Vitest for unit tests and Playwright for E2E tests. The story file specifically calls for unit testing the `HabitCreator` component in isolation.</standards>
    <locations>
      <location kind="Unit">/tests/unit/</location>
      <location kind="E2E">/tests/e2e/</location>
    </locations>
    <ideas>
      <idea for="AC-3, AC-4">Create a Playwright E2E test that asserts that the `HabitCreator` component is rendered within "The Pile" section of the dashboard.</idea>
      <idea for="AC-6">A Vitest/RTL unit test should be written for the `HabitCreator` component to simulate user input and verify that it doesn't throw errors.</idea>
      <idea for="AC-4">A visual regression test could be added to the Playwright suite to ensure the `HabitCreator` is styled correctly.</idea>
    </ideas>
  </tests>
</story-context>
